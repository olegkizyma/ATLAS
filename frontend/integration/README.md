# Atlas TutorialChat Integration

## –û–ø–∏—Å

–¶–µ–π –º–æ–¥—É–ª—å –∑–∞–±–µ–∑–ø–µ—á—É—î —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é —Å–∏—Å—Ç–µ–º–∏ TutorialChat –∑ —Å–∏—Å—Ç–µ–º–æ—é Atlas, —Å—Ç–≤–æ—Ä—é—é—á–∏ –º—ñ—Å—Ç–æ–∫ –º—ñ–∂ –¥–≤–æ–º–∞ API —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç—ñ–≤ –¥–∞–Ω–∏—Ö.

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
Atlas System
     ‚îÇ
     ‚îú‚îÄ‚îÄ atlas_minimal_live.py (–≥–æ–ª–æ–≤–Ω–∏–π —Å–µ—Ä–≤–µ—Ä)
     ‚îÇ    ‚îÇ
     ‚îÇ    ‚îú‚îÄ‚îÄ integration/
     ‚îÇ    ‚îÇ    ‚îú‚îÄ‚îÄ chat_integration.py (–º–æ–¥—É–ª—å —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó)
     ‚îÇ    ‚îÇ    ‚îú‚îÄ‚îÄ tutorialchat.html (–≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
     ‚îÇ    ‚îÇ    ‚îî‚îÄ‚îÄ __init__.py
     ‚îÇ    ‚îÇ
     ‚îÇ    ‚îî‚îÄ‚îÄ TutorialChat/ (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ React)
     ‚îÇ         ‚îú‚îÄ‚îÄ components/
     ‚îÇ         ‚îú‚îÄ‚îÄ api/
     ‚îÇ         ‚îú‚îÄ‚îÄ hooks/
     ‚îÇ         ‚îî‚îÄ‚îÄ contexts/
     ‚îÇ
     ‚îî‚îÄ‚îÄ Goose API (–∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Å–µ—Ä–≤—ñ—Å)
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

### 1. `chat_integration.py`
- **AtlasChatIntegration**: –û—Å–Ω–æ–≤–Ω–∏–π –∫–ª–∞—Å —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó
- **–ê–¥–∞–ø—Ç–µ—Ä–∏ —Ñ–æ—Ä–º–∞—Ç—ñ–≤**: –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –º—ñ–∂ Atlas —Ç–∞ TutorialChat API
- **–û–±—Ä–æ–±–Ω–∏–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤**: SSE –ø–æ—Ç–æ–∫–∏, —Å–µ—Å—ñ—ó, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- **–°—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏**: –û–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è TutorialChat –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤

### 2. `tutorialchat.html`
- **–í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- **–ù–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è**: –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó
- **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —Ç–µ—Å—Ç–∏ API
- **–°—Ç–∞—Ç—É—Å**: –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

### 3. TutorialChat Components
- **BaseChat.tsx**: –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —á–∞—Ç—É
- **ChatContext.tsx**: –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å—Ç–∞–Ω—É
- **useMessageStream.ts**: –•—É–∫ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- **API —Ç–∏–ø–∏**: TypeScript –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è

## API Endpoints

### TutorialChat API (–∞–¥–∞–ø—Ç–æ–≤–∞–Ω–æ –¥–ª—è Atlas)

```
POST /api/chat/reply         # –ü–æ—Ç–æ–∫–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–∞—Ç—É
GET  /api/session/{id}/history # –Ü—Å—Ç–æ—Ä—ñ—è —Å–µ—Å—ñ—ó
POST /api/session           # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–µ—Å—ñ—ó
GET  /api/tutorialchat/config # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó
```

### Atlas API (–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ)

```
POST /api/chat              # –ü—Ä–æ—Å—Ç–∏–π —á–∞—Ç
POST /api/chat/stream       # –ü–æ—Ç–æ–∫–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
GET  /api/status           # –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º–∏
```

## –§–æ—Ä–º–∞—Ç–∏ –¥–∞–Ω–∏—Ö

### TutorialChat Request
```json
{
  "message": "–¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è",
  "session_name": "session_id",
  "model": "gpt-4",
  "temperature": 0.7
}
```

### Atlas Request (–∞–¥–∞–ø—Ç–æ–≤–∞–Ω–∏–π)
```json
{
  "message": "–¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è",
  "session_name": "session_id", 
  "session_type": "chat",
  "no_paraphrase": false,
  "tutorial_chat_metadata": {
    "original_request": {...},
    "integration_version": "1.0.0"
  }
}
```

### SSE Events
```json
{
  "type": "Message",
  "message": {
    "id": "msg_123",
    "role": "assistant", 
    "content": "–í—ñ–¥–ø–æ–≤—ñ–¥—å"
  },
  "timestamp": "2025-08-31T..."
}
```

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
cd /Users/dev/Documents/GitHub/ATLAS/frontend
python3 atlas_minimal_live.py
```

### 2. –î–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

```
http://localhost:8080/tutorialchat
```

### 3. API —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
# –¢–µ—Å—Ç —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó
curl -X POST http://localhost:8080/api/chat/reply \
  -H "Content-Type: application/json" \
  -d '{"message": "–ü—Ä–∏–≤—ñ—Ç", "session_name": "test"}'

# –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
curl http://localhost:8080/api/tutorialchat/config
```

## –ù–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è

### –õ–æ–≥–∏

```python
import logging
logging.getLogger('integration.chat_integration').setLevel(logging.DEBUG)
```

### –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç–∏ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è" –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ
- –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ SSE –ø–æ–¥—ñ–π
- –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è API –≤–∏–∫–ª–∏–∫—ñ–≤

### –°—Ç–∞—Ç—É—Å–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

- üü¢ **Connected**: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –ø—Ä–∞—Ü—é—î
- üü° **Connecting**: –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤ –ø—Ä–æ—Ü–µ—Å—ñ  
- üî¥ **Error**: –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

## –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

```bash
GOOSE_BASE_URL=http://127.0.0.1:3000
GOOSE_SECRET_KEY=your-secret-key
ATLAS_CORE_URL=http://127.0.0.1:8000
```

### Config —Ñ–∞–π–ª–∏

```yaml
# config.yaml
goose:
  base_url: "http://127.0.0.1:3000"
  secret_key: "test"

atlas_core:
  url: "http://127.0.0.1:8000"
```

## –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö API endpoints

```python
def _handle_new_api(self, handler):
    # –õ–æ–≥—ñ–∫–∞ –æ–±—Ä–æ–±–∫–∏
    pass

# –£ handle_tutorial_chat_api
elif path.startswith("/api/new"):
    return self._handle_new_api(handler)
```

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ç–∏–ø—ñ–≤ –ø–æ–¥—ñ–π

```python
def _adapt_atlas_to_tutorialchat(self, event):
    if event_type == 'new_event_type':
        tutorialchat_event.update({
            'new_field': event.get('data')
        })
```

## –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

- **Python 3.8+**
- **aiohttp**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ HTTP –∑–∞–ø–∏—Ç–∏
- **requests**: HTTP –∫–ª—ñ—î–Ω—Ç
- **pathlib**: –†–æ–±–æ—Ç–∞ –∑ —Ñ–∞–π–ª–æ–≤–æ—é —Å–∏—Å—Ç–µ–º–æ—é

## –°—Ç–∞—Ç—É—Å —Ä–æ–∑—Ä–æ–±–∫–∏

- ‚úÖ –ë–∞–∑–æ–≤–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è API
- ‚úÖ –ê–¥–∞–ø—Ç–µ—Ä–∏ —Ñ–æ—Ä–º–∞—Ç—ñ–≤ –¥–∞–Ω–∏—Ö  
- ‚úÖ –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- ‚úÖ SSE –ø–æ—Ç–æ–∫–æ–≤–∞ –ø–µ—Ä–µ–¥–∞—á–∞
- ‚úÖ –û–±—Ä–æ–±–∫–∞ —Å–µ—Å—ñ–π
- ‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤
- ‚è≥ WebSocket –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
- ‚è≥ –ü–æ–≤–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤

## –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–î–ª—è –ø–∏—Ç–∞–Ω—å —Ç–∞ –ø–æ–º–∏–ª–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ:
- –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞: `/logs`
- –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `/tutorialchat`
- API —Å—Ç–∞—Ç—É—Å: `/api/status`
