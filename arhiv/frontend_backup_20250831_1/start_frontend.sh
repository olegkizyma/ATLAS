#!/bin/bash

# ATLAS Frontend Launcher with Virtual Environment
# –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ frontend —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º

echo "üöÄ –ó–∞–ø—É—Å–∫ ATLAS Frontend..."

# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é frontend  
cd "$(dirname "$0")"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
if [ ! -d "venv" ]; then
    echo "‚ùå –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!"
    echo "–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞: ./setup_env.sh"
    exit 1
fi

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo "‚ö° –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
source venv/bin/activate

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo "üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
python -c "import requests; print('‚úÖ –ú–æ–¥—É–ª—å requests –¥–æ—Å—Ç—É–ø–µ–Ω')" || {
    echo "‚ùå –ú–æ–¥—É–ª—å requests –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    echo "–ó–∞–ø—É—Å—Ç–∏—Ç–µ: ./setup_env.sh"
    exit 1
}

# –ó–∞–ø—É—Å–∫ frontend
echo "üåê –ó–∞–ø—É—Å–∫ Atlas Minimal Live Frontend..."
echo "üì± –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞: http://localhost:8080"
echo ""

# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä --background
if [ "$1" = "--background" ] || [ "$1" = "-bg" ]; then
    echo "üîß –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ..."
    python atlas_minimal_live.py &
    FRONTEND_PID=$!
    echo "Frontend PID: $FRONTEND_PID"
    echo "–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: kill $FRONTEND_PID"
else
    echo "üîß –ó–∞–ø—É—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ (Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)..."
    python atlas_minimal_live.py
fi
